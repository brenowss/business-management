<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
      crossorigin="anonymous"
    />
    <script
      type="text/javascript"
      src="https://www.gstatic.com/charts/loader.js"
    ></script>
    <script>
      var chart_width = 260;
var chart_height = 245;
// Load the Visualization API and the corechart package.
google.charts.load("current", { packages: ["corechart"] });

// Set a callback to run when the Google Visualization API is loaded.
// Each chart will have its own callback function
google.charts.setOnLoadCallback(drawPieChart);

google.charts.setOnLoadCallback(drawBarChart);

google.charts.setOnLoadCallback(drawColumnChart);

google.charts.setOnLoadCallback(drawTrendlineChart);

// Callback that creates and populates a data table,
// instantiates the pie chart, passes in the data and
// draws it.

//Pie Chart
function drawPieChart() {
  // Create the data table.
  var data = new google.visualization.DataTable();
  data.addColumn("string", "Topping");
  data.addColumn("number", "Slices");
  data.addRows([
    {% for i in open_order %}
    {{[i["nm_cliente"], i['vlt_total']] | safe}},
    {% endfor %}
  ]);

  // Set chart options
  var options = {
    title: "Pedidos abertos",
    width: chart_width,
    height: chart_height,
    is3D: true,
    legend: { alignment: "start" },
    pieSliceTextStyle: { color: "#f5f5f5" },
    fontName: "Montserrat",
    tooltip: { isHtml: true }
  };

  // Instantiate and draw our chart, passing in some options.
  var chart = new google.visualization.PieChart(
    document.getElementById("pie_chart_div")
  );
  chart.draw(data, options);

}

// Bar chart
function drawBarChart() {
  // Create the data table.
  var data = google.visualization.arrayToDataTable([
    ["Nome", "Quantidade", { role: "style" }],
    {% for i in top_seller %}
    {{ [i['nm_representante'], i['vlt_total'], "#b87333"] | safe }},
    {% endfor %}
  ]);

  var view = new google.visualization.DataView(data);
  view.setColumns([
    0,
    1,
    { calc: "stringify", sourceColumn: 1, type: "string", role: "annotation" },
    2
  ]);

  var options = {
    title: "Top Vendedores",
    width: chart_width,
    height: chart_height,
    bar: { groupWidth: "95%" },
    legend: { position: "none" },
    fontName: "Montserrat",
    tooltip: { isHtml: true }
  };
  var chart = new google.visualization.BarChart(
    document.getElementById("bar_chart_div")
  );
  chart.draw(view, options);
}

// Column chart
function drawColumnChart() {
  var data = google.visualization.arrayToDataTable([
    ["Element", "Density", { role: "style" }],
    ["Copper", 8.94, "#b87333"],
    ["Silver", 10.49, "silver"],
    ["Gold", 19.3, "gold"],
    ["Platinum", 21.45, "color: #e5e4e2"]
  ]);

  var view = new google.visualization.DataView(data);
  view.setColumns([
    0,
    1,
    { calc: "stringify", sourceColumn: 1, type: "string", role: "annotation" },
    2
  ]);

  var options = {
    title: "Density of Precious Metals",
    width: chart_width,
    height: chart_height,
    bar: { groupWidth: "95%" },
    legend: { position: "none" },
    fontName: "Montserrat",
    tooltip: { isHtml: true }
  };
  var chart = new google.visualization.ColumnChart(
    document.getElementById("column_chart_div")
  );
  chart.draw(view, options);
}

//Trendline chart
function drawTrendlineChart() {
    var data = google.visualization.arrayToDataTable([
        ['X', 'Y'],
        {% for i in open_bill %}
        [new Date{{i['data_docto'] | safe}}, {{i['vlt_total'] | safe}}],
        {% endfor %}
      ]);

      var options = {
        title: "NOTAS ABERTAS",
        height: chart_height,
        width: chart_width,
        fontName: "Montserrat",
        legend: 'none',
        colors: ['#9575cd', '#33ac71'],
        pointShape: 'diamond',
        trendlines: {
          0: {
            type: 'exponential',
            pointSize: 20,
            opacity: 0.6,
            pointsVisible: false
          },
          1: {
            type: 'linear',
            pointSize: 10,
            pointsVisible: true
          }
        }
      };

      var chart = new google.visualization.ScatterChart(document.getElementById('trendline_chart_div'));

      chart.draw(data, options);

      var data = google.visualization.arrayToDataTable([
        ['X', 'Y'],
        {% for i in last_30_month %}
        [new Date{{i['data_docto'] | safe}}, {{i['vlt_total'] | safe}}],
        {% endfor %}
      ]);

      var options = {
        title: "ùltimos 30 dias",
        height: chart_height,
        width: chart_width,
        fontName: "Montserrat",
        legend: 'none',
        colors: ['#9575cd', '#33ac71'],
        pointShape: 'diamond',
        trendlines: {
          0: {
            type: 'exponential',
            pointSize: 20,
            opacity: 0.6,
            pointsVisible: false
          },
          1: {
            type: 'linear',
            pointSize: 10,
            pointsVisible: true
          }
        }
      };

      var chart = new google.visualization.ScatterChart(document.getElementById('trendline_chart_div_2'));

      chart.draw(data, options);
}

    </script>
    <!--    <script src="{{ url_for('static', filename='./charts.js') }}"></script>-->

    <link rel="stylesheet" href="{{ url_for('static', filename='./style.css') }}" />
    <title>Business Management</title>
  </head>
  <body id="css-override">
    <nav class="navbar">
      <div class="nav-div">
        <h4 class="logo">Logo</h4>
        <ul>
          <li>
            <a href="" class="nav-link"
              ><i class="fas fa-money-bill-alt"></i
            ></a>
          </li>
          <li>
            <a href="" class="nav-link"><i class="fas fa-chart-pie"></i></a>
          </li>
          <li>
            <a href="" class="nav-link"><i class="fas fa-chart-line"></i></a>
          </li>
          <li>
            <a href="" class="nav-link"><i class="fas fa-chart-bar"></i></a>
          </li>
          <li>
            <button id="modal_open" class="nav-link config"><i class="fas fa-cog"></i></button>
          </li>
        </ul>
        <div class="theme-switch-wrapper">
          <label class="theme-switch" for="themeSwitch">
            <input type="checkbox" id="themeSwitch" />
            <div class="slider round"></div>
          </label>
        </div>
      </div>
    </nav>
    <main>
      <div class="cards">
        <div class="card card1" id="pie_chart_div"></div>
        <div class="card card2" id="bar_chart_div"></div>
        <div class="card card3" id="column_chart_div"></div>
        <div class="card card4" id="trendline_chart_div"></div>
        <div class="card card5" id="trendline_chart_div_2"></div>
        <div class="card card6"></div>
        <div class="card card7"></div>
        <div class="card card8"></div>
        <div class="card card9"></div>
        <div class="card card10"></div>
        <div class="card card11"></div>
        <div class="card card12"></div>
        <div class="card card13"></div>
        <div class="card card14"></div>
        <div class="card card15"></div>
        <div class="card card16"></div>
      </div>
    </main>

    <!-- Modal de configuração -->
    <div class="cfg-modal hidden" id="cfg_modal">
      <h2>Configurações</h2>
      <button id="modal_close"><img src="{{ url_for('static', filename='./close.svg') }}" alt="Fechar configurações"></button>
      <div class="cfg">
        <div class="cfg-wrapper">
          <div class="cfg-label">
            Primeira Configuração
          </div>
          <div class="cfg-toggle">
            <label class="switch">
              <input type="checkbox">
              <span class="slider round"></span>
            </label>
          </div>
        </div> <div class="cfg-wrapper">
          <div class="cfg-label">
            Segunda Configuração
          </div>
          <div class="cfg-toggle">
            <label class="switch">
              <input type="checkbox">
              <span class="slider round"></span>
            </label>
          </div>
        </div> <div class="cfg-wrapper">
          <div class="cfg-label">
            Terceira Configuração
          </div>
          <div class="cfg-toggle">
            <label class="switch">
              <input type="checkbox">
              <span class="slider round"></span>
            </label>
          </div>
        </div>
      </div>
    </div>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"
      integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0="
      crossorigin="anonymous"
    ></script>
    <script src="{{ url_for('static', filename='./main.js') }}"></script>
  </body>
</html>
